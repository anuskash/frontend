<nav class="navbar">
  <div class="nav-container">
    <!-- Logo + Home -->
    <a (click)="goHome()" class="logo" title="Home">
      <svg width="40" height="40" viewBox="0 0 40 40" fill="none">
        <rect width="40" height="40" rx="8" fill="url(#gradient1)" />
        <path d="M12 20L18 26L28 14" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" />
        <defs>
          <linearGradient id="gradient1" x1="0" y1="0" x2="40" y2="40">
            <stop offset="0%" stop-color="#ffe259" />
            <stop offset="100%" stop-color="#ffa751" />
          </linearGradient>
        </defs>
      </svg>
      <div class="brand-text">
        <span class="brand-name">UON Marketplace</span>
        <span class="brand-tagline">Student Buy & Sell</span>
      </div>
    </a>

    <!-- Links -->
    <div class="nav-links">
      <a (click)="goHome()" class="nav-link" [class.active]="router.url==='/' || router.url.startsWith('/user-dashboard')">
        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path d="M3 12l9-9 9 9" />
          <path d="M9 21V9h6v12" />
        </svg>
        Home
      </a>
      <a routerLink="/browse-listings" class="nav-link" routerLinkActive="active">
        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
        Browse
      </a>
      <a *ngIf="isLoggedIn && isAdmin" routerLink="/admin" class="nav-link" routerLinkActive="active">
        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <rect x="3" y="3" width="18" height="14" rx="2" ry="2"></rect>
          <line x1="8" y1="21" x2="16" y2="21"></line>
        </svg>
        Admin
      </a>
      <a *ngIf="isLoggedIn" routerLink="/my-listings" class="nav-link" routerLinkActive="active">
        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <rect x="3" y="3" width="7" height="7"></rect>
          <rect x="14" y="3" width="7" height="7"></rect>
          <rect x="14" y="14" width="7" height="7"></rect>
          <rect x="3" y="14" width="7" height="7"></rect>
        </svg>
        My Listings
      </a>
      <a *ngIf="isLoggedIn" routerLink="/my-purchases" class="nav-link" routerLinkActive="active">
        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <circle cx="9" cy="21" r="1"></circle>
          <circle cx="20" cy="21" r="1"></circle>
          <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
        </svg>
        My Purchases
      </a>
      <a *ngIf="isLoggedIn" routerLink="/my-reviews" class="nav-link" routerLinkActive="active">
        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
        </svg>
        My Reviews
      </a>
    </div>


    <!-- Actions -->
    <div class="nav-actions">
      <button *ngIf="isLoggedIn" (click)="goToAddListing()" class="btn-post-ad">
        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <line x1="12" y1="5" x2="12" y2="19"></line>
          <line x1="5" y1="12" x2="19" y2="12"></line>
        </svg>
        Sell Item
      </button>

      <button *ngIf="isLoggedIn" class="btn-messages" (click)="openMessages()" title="Messages">
        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
        </svg>
        <span class="message-badge" *ngIf="unreadMessagesCount > 0">{{ unreadMessagesCount }}</span>
      </button>

      <!-- Notification Bell Button (moved next to messages) -->
      <a *ngIf="isLoggedIn" routerLink="/notifications" class="btn-notifications" title="Notifications">
        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path d="M18 16v-5a6 6 0 1 0-12 0v5l-2 2v1h16v-1l-2-2z"/>
          <path d="M13.73 21a2 2 0 0 1-3.46 0"/>
        </svg>
        <span *ngIf="unreadNotificationsCount > 0" class="notification-badge">{{ unreadNotificationsCount }}</span>
      </a>

      <div class="user-menu" *ngIf="currentUser">
        <button class="user-avatar" (click)="toggleUserMenu()">
          <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
          <span class="user-name">{{ getUserName() }}</span>
          <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24" class="chevron">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </button>

        <div class="dropdown-menu" [class.show]="showUserMenu">
          <div class="dropdown-header">
            <div class="user-email">{{ currentUser.email }}</div>
          </div>
          <div class="dropdown-divider"></div>
          <a (click)="goToProfile(); toggleUserMenu()" class="dropdown-item">
            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
            Account Settings
          </a>
          <a routerLink="/user-dashboard" (click)="toggleUserMenu()" class="dropdown-item">
            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <rect x="3" y="3" width="7" height="7"></rect>
              <rect x="14" y="3" width="7" height="7"></rect>
              <rect x="14" y="14" width="7" height="7"></rect>
              <rect x="3" y="14" width="7" height="7"></rect>
            </svg>
            Dashboard
          </a>
          <a routerLink="/saved-products" (click)="toggleUserMenu()" class="dropdown-item">
            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
            </svg>
            Saved Products
          </a>
          <div class="dropdown-divider"></div>
            <a *ngIf="isAdmin" routerLink="/admin" (click)="toggleUserMenu()" class="dropdown-item">
              <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <rect x="3" y="3" width="18" height="14" rx="2" ry="2"></rect>
                <line x1="8" y1="21" x2="16" y2="21"></line>
              </svg>
              Admin Dashboard
            </a>
            <div class="dropdown-divider"></div>
          <a (click)="onLogout(); toggleUserMenu()" class="dropdown-item danger">
            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
              <polyline points="16 17 21 12 16 7"></polyline>
              <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
            Logout
          </a>
        </div>
      </div>

      <!-- Guest actions -->
      <div class="guest-actions" *ngIf="!isLoggedIn">
        <a *ngIf="!isLoginPage" routerLink="/login" class="nav-link">Login</a>
        <a *ngIf="!isRegisterPage" routerLink="/register" class="nav-link">Register</a>
      </div>
    </div>
  </div>
</nav>
